from peewee import *
import json
import numpy
from scipy import stats

app_cat_map = {u'Google Wallet': u'Payment Processors', u'Varnish': u'Cache Tools', u'Phaser': u'JavaScript Frameworks', u'openEngine': u'CMS', u'Rapid Logic': u'Web Servers', u'jQTouch': u'Mobile Frameworks', u'Gravity Insights': u'Analytics', u'Lazy.js': u'JavaScript Frameworks', u'Demandware': u'eCommerce', u'IBM WebSphere Commerce': u'eCommerce', u'ATG Web Commerce': u'eCommerce', u'Flask': u'Web Servers', u'Clicky': u'Analytics', u'Zope': u'Web Servers', u'Hammer.js': u'JavaScript Frameworks', u'LiteSpeed': u'Web Servers', u'Kentico CMS': u'CMS', u'Fedora': u'Operating Systems', u'Danneo CMS': u'CMS', u'Hippo': u'CMS', u'WikkaWiki': u'Wikis', u'Tealeaf': u'Analytics', u'reCAPTCHA': u'CAPTCHAs', u'LiveJournal': u'Blogs', u'Scientific Linux': u'Operating Systems', u'Moodle': u'LMS', u'Dancer': u'Web Frameworks', u'TomatoCart': u'eCommerce', u'Bolt': u'CMS', u'swift.engine': u'CMS', u'Apache': u'Web Servers', u'Google PageSpeed': u'Web Server Extensions', u'Bluefish': u'Editors', u'thttpd': u'Web Servers', u'webEdition': u'CMS', u'Lightbox': u'Photo Galleries', u'AlloyUI': u'JavaScript Frameworks', u'mod_jk': u'Web Server Extensions', u'WebGUI': u'CMS', u'Banshee': u'Web Frameworks', u'Adzerk': u'Advertising Networks', u'script.aculo.us': u'JavaScript Frameworks', u'Intel Active Management...': u'Web Servers', u'TypePad': u'Blogs', u'Slimbox': u'Photo Galleries', u'Drupal Commerce': u'eCommerce', u'GitBook': u'Documentation Tools', u'Phusion Passenger': u'Web Servers', u'Wolf CMS': u'CMS', u'Indico': u'CMS', u'Ruby': u'Programming Languages', u'Pure CSS': u'Web Frameworks', u'Canon': u'Printers', u'NOIX': u'Miscellaneous', u'Adobe RoboHelp': u'Documentation Tools', u'LimeSurvey': u'Miscellaneous', u'Concrete5': u'CMS', u'AOLserver': u'Web Servers', u'Kolibri CMS': u'CMS', u'osCSS': u'eCommerce', u'jQuery Sparklines': u'Javascript Graphics', u'Backbone.js': u'JavaScript Frameworks', u'AddShoppers': u'Widgets', u'Contenido': u'CMS', u'Swiftlet': u'Web Frameworks', u'Hiawatha': u'Web Servers', u'DTG': u'CMS', u'GX WebManager': u'CMS', u'JS Charts': u'Javascript Graphics', u'Discourse': u'Message Boards', u'BigDump': u'Database Managers', u'Slimbox 2': u'Photo Galleries', u'DotNetNuke': u'CMS', u'Yandex.Metrika': u'Analytics', u'Adobe Muse': u'Editors', u'Optimizely': u'Analytics', u'Mozard Suite': u'CMS', u'D3': u'Javascript Graphics', u'eHTTP': u'Web Servers', u'OpenNemas': u'CMS', u'Fortune3': u'eCommerce', u'Indexhibit': u'CMS', u'sIFR': u'Font Scripts', u'1C-Bitrix': u'CMS', u'RBS Change': u'eCommerce', u'Solodev': u'CMS', u'Weebly': u'CMS', u'Coppermine': u'Photo Galleries', u'ZK': u'Web Frameworks', u'Incapsula': u'CDN', u'Amaya': u'Editors', u'EPrints': u'Miscellaneous', u'Twitter Flight': u'JavaScript Frameworks', u'Gravatar': u'Miscellaneous', u'Apache Tomcat': u'Web Servers', u'Logitech Media Server': u'Web Servers', u'Lo-dash': u'JavaScript Frameworks', u'Leaflet': u'Maps', u'Zeuscart': u'eCommerce', u'Splunkd': u'Web Servers', u'Atlassian Bitbucket': u'Dev Tools', u'Winstone Servlet Container': u'Web Servers', u'Webs': u'CMS', u'YaBB': u'Message Boards', u'PerfSONAR-PS': u'Miscellaneous', u'Oracle HTTP Server': u'Web Servers', u'Bigware': u'eCommerce', u'Invenio': u'Document Management Systems', u'Venda': u'eCommerce', u'OWL Carousel': u'Widgets', u'FAST Search for SharePoint': u'Search Engines', u'Twitter typeahead.js': u'JavaScript Frameworks', u'WooCommerce': u'eCommerce', u'AT Internet XiTi': u'Analytics', u'Apache Hadoop': u'Databases', u'TinyMCE': u'Rich Text Editors', u'Yii': u'Web Frameworks', u'TrackJs': u'Analytics', u'KS_HTTP': u'Web Servers', u'Oracle Web Cache': u'Cache Tools', u'Sentinel License Monitor': u'Miscellaneous', u'Sizmek': u'Advertising Networks', u'Arc Forum': u'Message Boards', u'Prototype': u'JavaScript Frameworks', u'Advert Stream': u'Advertising Networks', u'Websale': u'eCommerce', u'Windows CE': u'Operating Systems', u'PencilBlue': u'CMS', u'CS Cart': u'eCommerce', u'Express': u'Web Frameworks', u'Eloqua': u'Marketing Automation', u'SilverStripe': u'CMS', u'Subrion': u'CMS', u'AngularJS': u'JavaScript Frameworks', u'CompaqHTTPServer': u'Web Servers', u'Web2py': u'Web Frameworks', u'Solr': u'Databases', u'Jirafe': u'Marketing Automation', u'Twitter Emoji (Twemoji)': u'Javascript Graphics', u'SPIP': u'CMS', u'Ametys': u'CMS', u'SUSE': u'Operating Systems', u'Quick.CMS': u'CMS', u'Nepso': u'CMS', u'Fusion Ads': u'Advertising Networks', u'ATEN': u'Web Servers', u'Meebo': u'Widgets', u'Indy': u'Web Servers', u'MyBB': u'Message Boards', u'Pligg': u'CMS', u'Fireblade': u'CDN', u'Hello Bar': u'Widgets', u'DHTMLX': u'JavaScript Frameworks', u'Hotaru CMS': u'CMS', u'Mojolicious': u'Web Frameworks', u'David Webbox': u'Web Servers', u'RCMS': u'CMS', u'Glyphicons': u'Font Scripts', u'mod_dav': u'Web Server Extensions', u'RAID HTTPServer': u'Web Servers', u'DokuWiki': u'Wikis', u'NVD3': u'Javascript Graphics', u'Xitami': u'Web Servers', u'Highstock': u'Javascript Graphics', u'Google Analytics': u'Analytics', u'vBulletin': u'Message Boards', u'ClickHeat': u'Analytics', u'Serendipity': u'CMS', u'Flyspray': u'Issue Trackers', u'ImpressPages': u'CMS', u'shine.js': u'Javascript Graphics', u'HP System Management': u'Remote Access', u'Atlassian Jira Issue Collector': u'Issue Trackers', u'PayPal': u'Payment Processors', u'IBM Tivoli Storage Manager': u'Web Servers', u'BuySellAds': u'Advertising Networks', u'Mura CMS': u'CMS', u'Erlang': u'Programming Languages', u'Cufon': u'Font Scripts', u'mod_ssl': u'Web Server Extensions', u'OneStat': u'Analytics', u'IIS': u'Web Servers', u'EmbedThis Appweb': u'Web Servers', u'Intercom': u'Analytics', u'Dell': u'Printers', u'Jekyll': u'CMS', u'Shadow': u'Web Frameworks', u'Ghost': u'Blogs', u'Avangate': u'eCommerce', u'EdgeCast': u'CDN', u'TYPO3 Flow': u'Web Frameworks', u'Oracle Application Server': u'Web Servers', u'Schneider': u'Control Systems', u'Alloy': u'JavaScript Frameworks', u'Django': u'Web Frameworks', u'RequireJS': u'JavaScript Frameworks', u'GitLab CI': u'Dev Tools', u'xajax': u'JavaScript Frameworks', u'Umbraco': u'CMS', u'Google Charts': u'Javascript Graphics', u'Oracle Recommendations On Demand': u'Analytics', u'Moment Timezone': u'JavaScript Frameworks', u'PANSITE': u'CMS', u'WordPress': u'CMS', u'WebPublisher': u'CMS', u'RxJS': u'JavaScript Frameworks', u'Google Sites': u'CMS', u'Nedstat': u'Analytics', u'yepnope.js': u'JavaScript Frameworks', u'Catwalk': u'Web Servers', u'Dojo': u'JavaScript Frameworks', u'RiteCMS': u'CMS', u'Apache Traffic Server': u'Web Servers', u'Shopatron': u'eCommerce', u'WebsiteBaker': u'CMS', u'OpenSSL': u'Web Server Extensions', u'October CMS': u'CMS', u'TwistedWeb': u'Web Servers', u'Woopra': u'Analytics', u'HubSpot': u'Marketing Automation', u'iWeb': u'Editors', u'X-Cart': u'eCommerce', u'LightMon Engine': u'CMS', u'eZ Publish': u'eCommerce', u'Nginx': u'Web Servers', u'Movable Type': u'CMS', u'Disqus': u'Comment Systems', u'SAP': u'Web Servers', u'Ubercart': u'eCommerce', u'papaya CMS': u'CMS', u'gitweb': u'Dev Tools', u'FreeBSD': u'Operating Systems', u'Cloudera': u'Databases', u'Google Maps': u'Maps', u'Brother': u'Printers', u'Jetty': u'Web Servers', u'Knockout.js': u'JavaScript Frameworks', u'Joomla': u'CMS', u'Google App Engine': u'Web Servers', u'Happy ICS Server': u'Web Servers', u'UltraCart': u'eCommerce', u'HP ProCurve': u'Network Devices', u'Bonfire': u'Web Frameworks', u'CherryPy': u'Web Servers', u'IPB': u'Message Boards', u'Outlook Web App': u'Web Mail', u'Gauges': u'Analytics', u'K2': u'Miscellaneous', u'Reinvigorate': u'Analytics', u'Less': u'Miscellaneous', u'OmniTouch 8660 My Teamwork': u'Miscellaneous', u'MyBlogLog': u'Widgets', u'Ushahidi': u'Maps', u'FAST ESP': u'Search Engines', u'Kohana': u'Web Frameworks', u'ImpressCMS': u'CMS', u'Yandex.Direct': u'Advertising Networks', u'MochiWeb': u'Web Servers', u'jQuery': u'JavaScript Frameworks', u'Catberry.js': u'Web Frameworks', u'Twitter Bootstrap': u'Web Frameworks', u'Reveal.js': u'JavaScript Frameworks', u'SWFObject': u'Miscellaneous', u'CacheFly': u'CDN', u'Perl': u'Programming Languages', u'Burning Board': u'Message Boards', u'Lua': u'Programming Languages', u'VisualPath': u'Analytics', u'Mean.io': u'JavaScript Frameworks', u'Vue.js': u'JavaScript Frameworks', u'Mollom': u'CAPTCHAs', u'BrowserCMS': u'CMS', u'SublimeVideo': u'Video Players', u'InstantCMS': u'CMS', u'IBM HTTP Server': u'Web Servers', u'Timeplot': u'Javascript Graphics', u'Airee': u'CDN', u'DedeCMS': u'CMS', u'ownCloud': u'Miscellaneous', u'Magento': u'eCommerce', u'Spree': u'eCommerce', u'AWStats': u'Analytics', u'HTTP-Server': u'Web Servers', u'Dotclear': u'CMS', u'punBB': u'Message Boards', u'gunicorn': u'Web Servers', u'Veoxa': u'Advertising Networks', u'comScore': u'Analytics', u'e107': u'CMS', u'Planet': u'Feed Readers', u'mod_python': u'Web Server Extensions', u'phpwind': u'Message Boards', u'JavaServer Faces': u'Web Frameworks', u'mod_fastcgi': u'Web Server Extensions', u'HP iLO': u'Web Servers', u'Twilight CMS': u'CMS', u'Contao': u'CMS', u'Chitika': u'Advertising Networks', u'INFOnline': u'Analytics', u'Tumblr': u'Blogs', u'Webtrekk': u'Analytics', u'ExpressionEngine': u'CMS', u'JBoss Web': u'Web Servers', u'xui': u'Mobile Frameworks', u'Moguta.CMS': u'eCommerce', u'Red Hat': u'Operating Systems', u'MiniBB': u'Message Boards', u'jQuery Mobile': u'Mobile Frameworks', u'Cherokee': u'Web Servers', u'TiddlyWiki': u'Wikis', u'ELOG': u'Miscellaneous', u'New Relic': u'Analytics', u'InProces': u'CMS', u'Sentinel Protection Server': u'Web Servers', u'Lockerz Share': u'Widgets', u'ZURB Foundation': u'Web Frameworks', u'mod_auth_pam': u'Web Server Extensions', u'Google Code Prettify': u'Miscellaneous', u'Synology DiskStation': u'Network Storage', u'Open Classifieds': u'eCommerce', u'UIKit': u'Web Frameworks', u'Django CMS': u'CMS', u'SobiPro': u'Miscellaneous', u'basket.js': u'JavaScript Frameworks', u'E-Merchant': u'eCommerce', u'Debian': u'Operating Systems', u'Artifactory Web Server': u'Web Servers', u'Gambio': u'eCommerce', u'jqPlot': u'Javascript Graphics', u'Koala Framework': u'Web Frameworks', u'lighttpd': u'Web Servers', u'Squarespace': u'CMS', u'HERE': u'Maps', u'Bugzilla': u'Issue Trackers', u'osCommerce': u'eCommerce', u'3DM': u'Miscellaneous', u'Cross Pixel': u'Analytics', u'Adcash': u'Advertising Networks', u'Monkey HTTP Server': u'Web Servers', u'Blip.tv': u'Video Players', u'YUI': u'JavaScript Frameworks', u'Ionicons': u'Font Scripts', u'MongoDB': u'Databases', u'Titan': u'Advertising Networks', u'Ramda': u'JavaScript Frameworks', u'Netmonitor': u'Analytics', u'xCharts': u'Javascript Graphics', u'Connect': u'Web Frameworks', u'DreamWeaver': u'Editors', u'Blogger': u'Blogs', u'cgit': u'Miscellaneous', u'CKEditor': u'Rich Text Editors', u'Microsoft SharePoint': u'CMS', u'Snap.svg': u'JavaScript Frameworks', u'Protovis': u'Javascript Graphics', u'Percussion': u'CMS', u'Jenkins': u'Build/CI Systems', u'UserVoice': u'Issue Trackers', u'DirectAdmin': u'Hosting Panels', u'Craft CMS': u'CMS', u'HP Compact Server': u'Web Servers', u'AMPcms': u'CMS', u'Anchor CMS': u'CMS', u'MediaElement.js': u'Video Players', u'Open AdStream': u'Advertising Networks', u'Haskell': u'Programming Languages', u'cPanel': u'Hosting Panels', u'RoundCube': u'Web Mail', u'Grandstream': u'Webcams', u'PHP-Fusion': u'CMS', u'Gallery': u'Photo Galleries', u'three.js': u'Javascript Graphics', u'Trac': u'Issue Trackers', u'Netsuite': u'eCommerce', u'Oracle Dynamic Monitoring...': u'Miscellaneous', u'OpenCart': u'eCommerce', u'C++': u'Programming Languages', u'AsciiDoc': u'Programming Languages', u'TeamCity': u'Build/CI Systems', u'AddThis': u'Widgets', u'Store Systems': u'eCommerce', u'Google AdSense': u'Advertising Networks', u'Locomotive': u'CMS', u'Squiz Matrix': u'CMS', u'Supersized': u'Photo Galleries', u'ELOG HTTP': u'Web Servers', u'SiteCatalyst': u'Analytics', u'Adobe ColdFusion': u'Web Frameworks', u'Dokeos': u'LMS', u'Commerce Server': u'eCommerce', u'Socket.io': u'JavaScript Frameworks', u'SpiderControl iniNet': u'Control Systems', u'Mambo': u'CMS', u'HeadJS': u'JavaScript Frameworks', u'Hogan.js': u'JavaScript Frameworks', u'Kooboo CMS': u'CMS', u'Moxa': u'Network Devices', u'Site Meter': u'Analytics', u'WebsPlanet': u'CMS', u'Parse.ly': u'Analytics', u'Sencha Touch': u'Mobile Frameworks', u'Plesk': u'Hosting Panels', u'TYPO3 CMS': u'CMS', u'node.js': u'Programming Languages', u'phpCMS': u'CMS', u'Redmine': u'Issue Trackers', u'Chamilo': u'LMS', u'TWiki': u'Wikis', u'MySQL': u'Databases', u'Criteo': u'Advertising Networks', u'CenteHTTPd': u'Web Servers', u'Liferay': u'CMS', u'GoAhead': u'Web Servers', u'Canon HTTP Server': u'Web Servers', u'Reddit': u'Message Boards', u'Open Journal Systems': u'Document Management Systems', u'1und1': u'eCommerce', u'Tiki Wiki CMS Groupware': u'Wikis', u'Ruby on Rails': u'Web Frameworks', u'Jo': u'Mobile Frameworks', u'Open Web Analytics': u'Analytics', u'Stripe': u'Payment Processors', u'MochiKit': u'JavaScript Frameworks', u'Wowza Media Server': u'Media Servers', u'Boba.js': u'JavaScript Frameworks', u'Yahoo Advertising': u'Advertising Networks', u'Windows Server': u'Operating Systems', u'Kendo UI': u'Web Frameworks', u'Komodo CMS': u'CMS', u'VirtueMart': u'eCommerce', u'TweenMax': u'JavaScript Frameworks', u'Paths.js': u'Javascript Graphics', u'Exhibit': u'Javascript Graphics', u'Polymer': u'JavaScript Frameworks', u'Intershop': u'eCommerce', u'SiteEdit': u'CMS', u'SweetAlert': u'JavaScript Frameworks', u'MaxSite CMS': u'CMS', u'Methode': u'CMS', u'Koego': u'Analytics', u'MathJax': u'Javascript Graphics', u'PHP': u'Programming Languages', u'Pardot': u'Marketing Automation', u'FrontPage': u'Editors', u'Eleanor CMS': u'CMS', u'dwhttpd': u'Web Servers', u'Modernizr': u'JavaScript Frameworks', u'phpSQLiteCMS': u'CMS', u'AT Internet Analyzer': u'Analytics', u'Amiro.CMS': u'CMS', u'Epoch': u'Javascript Graphics', u'IBM WebSphere Portal': u'CMS', u'Akamai': u'CDN', u'WordPress Super Cache': u'Cache Tools', u'Koken': u'CMS', u'Mondo Media': u'eCommerce', u'MOBOTIX': u'Webcams', u'Epom': u'Advertising Networks', u'Sivuviidakko': u'CMS', u'debut': u'Web Servers', u'BittAds': u'Advertising Networks', u'Font Awesome': u'Font Scripts', u'Prefix-Free': u'Miscellaneous', u'Virata EmWeb': u'Web Servers', u'total.js': u'Web Frameworks', u'Adobe GoLive': u'Editors', u'Volusion': u'eCommerce', u'GlassFish': u'Web Servers', u'Rickshaw': u'Javascript Graphics', u'Motion-httpd': u'Web Servers', u'spin.js': u'Javascript Graphics', u'SPDY': u'Miscellaneous', u'LinkSmart': u'Advertising Networks', u'Shopware': u'eCommerce', u'Smartstore': u'eCommerce', u'XOOPS': u'CMS', u'UNIX': u'Operating Systems', u'SIMsite': u'CMS', u'Sarka-SPIP': u'CMS', u'Bigcommerce': u'eCommerce', u'Enyo': u'Mobile Frameworks', u'Mobify': u'Mobile Frameworks', u'AdRiver': u'Advertising Networks', u'Embedthis-http': u'Web Servers', u'Moogo': u'CMS', u'Zanox': u'Advertising Networks', u'OpenCms': u'CMS', u'Textpattern CMS': u'CMS', u'eDevice SmartStack': u'Web Servers', u'Smart Ad Server': u'Advertising Networks', u'Yahoo! Web Analytics': u'Analytics', u'JBoss Application Server': u'Web Servers', u'Silva': u'CMS', u'Shopify': u'eCommerce', u'SimpleHTTP': u'Web Servers', u'MooTools': u'JavaScript Frameworks', u'Prestashop': u'eCommerce', u'OpenLayers': u'Maps', u'Quick.Cart': u'eCommerce', u'UserRules': u'Issue Trackers', u'Snoobi': u'Analytics', u'Chartbeat': u'Analytics', u'Ember.js': u'JavaScript Frameworks', u'phpDocumentor': u'Documentation Tools', u'Plentymarkets': u'eCommerce', u'Vignette': u'CMS', u'Fact Finder': u'Search Engines', u'Atlassian FishEye': u'Dev Tools', u'Crazy Egg': u'Analytics', u'Business Catalyst': u'CMS', u'TwistPHP': u'Web Frameworks', u'Ophal': u'Web Frameworks', u'ShinyStat': u'Analytics', u'Open eShop': u'eCommerce', u'S.Builder': u'CMS', u'Vanilla': u'Message Boards', u'Splunk': u'Miscellaneous', u'AdRoll': u'Advertising Networks', u'mod_rack': u'Web Server Extensions', u'XMB': u'Message Boards', u'Adobe CQ5': u'CMS', u'VIVVO': u'CMS', u'Highcharts': u'Javascript Graphics', u'BugSense': u'Analytics', u'CMSimple': u'CMS', u'Saia PCD': u'Control Systems', u'SunOS': u'Operating Systems', u'GetSimple CMS': u'CMS', u'SyntaxHighlighter': u'Miscellaneous', u'sNews': u'CMS', u'Project Wonderful': u'Advertising Networks', u'amCharts': u'Javascript Graphics', u'Sitecore': u'CMS', u'MiniServ': u'Web Servers', u'iCongo': u'eCommerce', u'Allegro RomPager': u'Web Servers', u'WP Rocket': u'Cache Tools', u'MODx': u'CMS', u'dashCommerce': u'eCommerce', u'Webtrends': u'Analytics', u'actionhero.js': u'Web Servers', u'CubeCart': u'eCommerce', u'ManyContacts': u'Widgets', u'OpenGSE': u'Web Servers', u'Advanced Web Stats': u'Analytics', u'Contens': u'CMS', u'phpBB': u'Message Boards', u'Zinnia': u'Blogs', u'ContentBox': u'CMS', u'OXID eShop': u'eCommerce', u'Webix': u'JavaScript Frameworks', u'Darwin': u'Operating Systems', u'Python': u'Programming Languages', u'eSyndiCat': u'CMS', u'KISSmetrics': u'Analytics', u'GitLab': u'Issue Trackers', u'CMS Made Simple': u'CMS', u'PHP-Nuke': u'Message Boards', u'Yieldlab': u'Advertising Networks', u'mod_wsgi': u'Web Server Extensions', u'SoundManager': u'JavaScript Frameworks', u'VP-ASP': u'eCommerce', u'Microsoft HTTPAPI': u'Web Servers', u'IntenseDebate': u'Comment Systems', u'Kampyle': u'Issue Trackers', u'Graffiti CMS': u'CMS', u'Raphael': u'Javascript Graphics', u'Accessible Portal': u'CMS', u'Mono.net': u'CMS', u'Cotonti': u'CMS', u'MediaTomb': u'Media Servers', u'YUI Doc': u'Documentation Tools', u'CFML': u'Programming Languages', u'Apache HBase': u'Databases', u'Zend': u'Web Servers', u'CouchDB': u'Web Servers', u'Mint': u'Analytics', u'Plone': u'CMS', u'Koa': u'Web Frameworks', u'Marketo': u'Marketing Automation', u'phpMyAdmin': u'Database Managers', u'Outbrain': u'Widgets', u'SDL Tridion': u'CMS', u'Livefyre': u'Comment Systems', u'FlexCMP': u'CMS', u'Microsoft ASP.NET': u'Web Frameworks', u'MantisBT': u'Issue Trackers', u'vis.js': u'Javascript Graphics', u'Apache JSPWiki': u'Wikis', u'FreeTextBox': u'Rich Text Editors', u'Java Servlet': u'Web Frameworks', u'Seoshop': u'eCommerce', u'Powergap': u'eCommerce', u'libwww-perl-daemon': u'Web Servers', u'FWP': u'eCommerce', u'XRegExp': u'JavaScript Frameworks', u'React': u'JavaScript Frameworks', u'Yahoo! Ecommerce': u'eCommerce', u'Gentoo': u'Operating Systems', u'JavaServer Pages': u'Web Frameworks', u'YouTube': u'Video Players', u'phpPgAdmin': u'Database Managers', u'M.R. Inc Wild CMS': u'eCommerce', u'mod_perl': u'Web Server Extensions', u'xtCommerce': u'eCommerce', u'CloudFlare': u'CDN', u'phpAlbum': u'Photo Galleries', u'Drupal': u'CMS', u'Mono': u'Web Frameworks', u'math.js': u'JavaScript Frameworks', u'Wink': u'Mobile Frameworks', u'Google Tag Manager': u'Tag Managers', u'Tengine': u'Web Servers', u'Jalios': u'CMS', u'CakePHP': u'Web Frameworks', u'Mixpanel': u'Analytics', u'CentOS': u'Operating Systems', u'Handlebars': u'JavaScript Frameworks', u'Boa': u'Web Servers', u'VigLink': u'Advertising Networks', u'DataLife Engine': u'CMS', u'Google Web Toolkit': u'Web Frameworks', u'LEPTON': u'CMS', u'FluxBB': u'Message Boards', u'Mynetcap': u'CMS', u'ConversionLab': u'Analytics', u'RackCache': u'Cache Tools', u'3dCart': u'eCommerce', u'Atlassian Jira': u'Issue Trackers', u'Ckan': u'CMS', u'Piano Solo': u'Paywalls', u'Laravel': u'Web Frameworks', u'Posterous': u'CMS', u'Java': u'Programming Languages', u'Scala': u'Programming Languages', u'M.R. Inc Webserver': u'Web Servers', u'HP': u'Printers', u'CO2Stats': u'Analytics', u'AdInfinity': u'Advertising Networks', u'Xanario': u'eCommerce', u'Artifactory': u'Dev Tools', u'Zepto': u'JavaScript Frameworks', u'XAMPP': u'Web Servers', u'Yesod': u'Web Servers', u'Lift': u'Web Frameworks', u'BugSnag': u'Analytics', u'RightJS': u'JavaScript Frameworks', u'mini_httpd': u'Web Servers', u'Get Satisfaction': u'Issue Trackers', u'Doxygen': u'Documentation Tools', u'ShareThis': u'Widgets', u'Google Font API': u'Font Scripts', u'RDoc': u'Documentation Tools', u'Nette Framework': u'Web Frameworks', u'Lucene': u'Databases', u'W3 Total Cache': u'Cache Tools', u'OpenGrok': u'Miscellaneous', u'MoinMoin': u'Wikis', u'JAlbum': u'Photo Galleries', u'AppNexus': u'Advertising Networks', u'W3Counter': u'Analytics', u'2z Project': u'CMS', u'CppCMS': u'CMS', u'SQL Buddy': u'Database Managers', u'Fat-Free Framework': u'Web Frameworks', u'Cosmoshop': u'eCommerce', u'uCore': u'Web Frameworks', u'JC-HTTPD': u'Web Servers', u'IBM Coremetrics': u'Analytics', u'viennaCMS': u'CMS', u'Elm': u'Programming Languages', u'Decorum': u'Web Servers', u'Carbon Ads': u'Advertising Networks', u'Petrojs': u'JavaScript Frameworks', u'StatCounter': u'Analytics', u'Po.st': u'Widgets', u'Meteor': u'JavaScript Frameworks', u'FlashCom': u'Web Servers', u'Hybris': u'eCommerce', u'SquirrelMail': u'Web Mail', u'git': u'Dev Tools', u'SOBI 2': u'Miscellaneous', u'CodeIgniter': u'Web Frameworks', u'Chameleon': u'CMS', u'CodeMirror': u'Miscellaneous', u'HP ChaiServer': u'Web Servers', u'Web Optimizer': u'Analytics', u'Typekit': u'Font Scripts', u'Ubuntu': u'Operating Systems', u'LiveStreet CMS': u'CMS', u'Lotus Domino': u'Web Servers', u'Sphinx': u'Documentation Tools', u'Cowboy': u'Web Servers', u'ESERV-10': u'Web Servers', u'Sentinel Keys Server': u'Web Servers', u'ClickTale': u'Analytics', u'Plura': u'Miscellaneous', u'TYPO3 Neos': u'CMS', u'CPG Dragonfly': u'CMS', u'Algolia Realtime Search': u'Search Engines', u'Mustache': u'JavaScript Frameworks', u'Mongrel': u'Web Servers', u'Zen Cart': u'eCommerce', u'MediaWiki': u'Wikis', u'PDF.js': u'Miscellaneous', u'Quantcast': u'Analytics', u'Starlet': u'Web Servers', u'Atlassian Confluence': u'Wikis', u'BIGACE': u'CMS', u'Vox': u'Blogs', u'ExtJS': u'JavaScript Frameworks', u'Schneider Web Server': u'Web Servers', u'Cargo': u'CMS', u'SmartSite': u'CMS', u'Green Valley CMS': u'CMS', u'Shopalize': u'Widgets', u'Moment.js': u'JavaScript Frameworks', u'KineticJS': u'Javascript Graphics', u'Underscore.js': u'JavaScript Frameworks', u'Javascript Infovis Toolkit': u'Javascript Graphics', u'mod_rails': u'Web Server Extensions', u'Snap': u'Web Servers', u'Lithium': u'CMS', u'EWS-NIC4': u'Web Servers', u'SQLite': u'Databases', u'TornadoServer': u'Web Servers', u'XenForo': u'Message Boards', u'Pagekit': u'CMS', u'Koobi': u'CMS', u'Dart': u'Programming Languages', u'io4 CMS': u'CMS', u'OpenText Web Solutions': u'CMS', u'DAV': u'Web Server Extensions', u'Vimeo': u'Video Players', u'Visual WebGUI': u'Web Frameworks', u'BaseHTTP': u'Web Servers', u'SMF': u'Message Boards', u'Dynamicweb': u'eCommerce', u'G-WAN': u'Web Servers', u'Deployd': u'JavaScript Frameworks', u'JTL Shop': u'eCommerce', u'jQuery UI': u'JavaScript Frameworks', u'prettyPhoto': u'Photo Galleries', u'EPiServer': u'CMS', u'GoStats': u'Analytics', u'Zabbix': u'Miscellaneous', u'3ware': u'Web Servers', u'Symfony': u'Web Frameworks', u'Apache Wicket': u'Web Frameworks', u'PostgreSQL': u'Databases', u'LabVIEW': u'Web Servers', u'VideoJS': u'Video Players', u'JobberBase': u'Miscellaneous', u'Thelia': u'eCommerce', u'nopCommerce': u'eCommerce', u'Piwik': u'Analytics', u'Wix': u'CMS'}

subdomains = ['ad', 'admin', 'ads', 'blog', 'cdn', 'cust1', 'customer', 'demo', 'dev', 'dns', 'dns1', 'download', 'flash', 'forum', 'ftp', 'games', 'img', 'image', 'm', 'mail', 'mobile', 'ns1', 'ns2', 'pics', 'proxy', 'sql', 'staing', 'static', 'test']  # 29
app_cats = ['Advertising Networks', 'CMS', 'eCommerce', 'Hosting Panels', 'Mobile Frameworks', 'Web Frameworks', 'Programming Languages', 'Web Servers', 'Operating Systems']  # 9

db = SqliteDatabase('domain.db')


class Domain(Model):
    name = CharField()
    categories = CharField()  # JSON str
    subdomains = TextField()  # JSON str
    apps = TextField()  # JSON str

    class Meta:
        database = db  # This model uses the "people.db" database.

print 'number_of_category,number_of_apps,number_of_subdomains,ad_network,cms,e_commerce,hosting_panel,mobile_framework,web_framework,programming_language,web_server,os,sub_ad,sub_admin,sub_ads,sub_blog,sub_cdn,sub_cust1,sub_customer,sub_demo,sub_dev,sub_dns,sub_dns1,sub_download,sub_flash,sub_forum,sub_ftp,sub_games,sub_img,sub_image,sub_m,sub_mail,sub_mobile,sub_ns1,sub_ns2,sub_pics,sub_proxy,sub_sql,sub_staing,sub_static,sub_test'

for domain in Domain.select().iterator():
    number_of_category = str(len(json.loads(domain.categories)))
    number_of_apps = str(len(json.loads(domain.apps)))
    number_of_subdomains = str(len(json.loads(domain.subdomains)))
    local_apps = ['N/A'] * 9
    for i in range(9):
        for app in json.loads(domain.apps):
            local_app = app.split('\\;')[0]
            if app_cat_map[local_app] == app_cats[i]:
                local_apps[i] = local_app
                break
    local_subs = [False] * 29
    subs = json.loads(domain.subdomains)
    for i in range(29):
        if subdomains[i] in subs:
            local_subs[i] = True
    str_local_subs = [str(e) for e in local_subs]
    print number_of_category+','+number_of_apps+','+number_of_subdomains+','+','.join(local_apps)+','+','.join(str_local_subs)


# for domain in Domain.select().iterator():
#     for cat in json.loads(domain.apps):
#         if not cat in number_of_cats:
#             number_of_cats[cat] = 0
#         number_of_cats[cat] += 1

# for k, v in number_of_cats.iteritems():
#     print k, '\t', v

# print 'mean', numpy.mean(number_of_cats)

# data = numpy.array(number_of_cats)
# print 'median', numpy.median(data)

# counts = numpy.bincount(data)
# print 'mod'
# print counts

# print 'std', data.std()
